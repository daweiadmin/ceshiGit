<!DOCTYPE html>

<include file="index/head" />
  <!-- END HEADER -->

  <!-- BEGIN CONTAINER -->

  <div class="page-container row-fluid">

    <!-- BEGIN SIDEBAR   MENU-->

      <include file="index/left" />

    <!-- END SIDEBAR -->

    <!-- BEGIN PAGE -->

    <div class="page-content">

      <!-- BEGIN SAMPLE PORTLET CONFIGURATION MODAL FORM-->

      <div id="portlet-config" class="modal hide">

        <div class="modal-header">

          <button data-dismiss="modal" class="close" type="button"></button>

          <h3>portlet Settings</h3>

        </div>

        <div class="modal-body">

          <p>Here will be a configuration form</p>

        </div>

      </div>

      <!-- END SAMPLE PORTLET CONFIGURATION MODAL FORM-->

      <!-- BEGIN PAGE CONTAINER-->        

      <div class="container-fluid">

        <!-- BEGIN PAGE HEADER-->

        <div class="row-fluid">

          <div class="span12">

            <!-- BEGIN STYLE CUSTOMIZER -->
                         
            <!-- END BEGIN STYLE CUSTOMIZER -->  

            <!-- BEGIN PAGE TITLE & BREADCRUMB-->

            <h3 class="page-title">

              代理商管理 <small>专业只做最好</small>

            </h3>

            <ul class="breadcrumb">


              <li>

                <a href="#">会员管理</a>

                <i class="icon-angle-right"></i>

              </li>

              <li><a href="#">代理商列表</a></li>

            </ul>

            <!-- END PAGE TITLE & BREADCRUMB-->

          </div>

        </div>

        <!-- END PAGE HEADER-->

        <!-- BEGIN PAGE CONTENT-->

        <div class="row-fluid">

          <div class="span12">

            <!-- BEGIN EXAMPLE TABLE PORTLET-->

            <div class="portlet box blue">

              <div class="portlet-title">

                <div class="caption"><i class="icon-edit"></i>代理商列表</div>

                <div class="tools">

                  <a href="javascript:;" class="collapse"></a>

                  <a href="#portlet-config" data-toggle="modal" class="config"></a>

                  <a href="javascript:;" class="reload"></a>

                  <a href="javascript:;" class="remove"></a>

                </div>

              </div>

              <div class="portlet-body">

                <div class="clearfix">

                  <div class="btn-group">
                     <!-- <button type="button" class="btn blue sel" attr-id="{$vo.id}" data-toggle="modal" href="#addclass">添加导航</button> -->
                      
                     <button id="delall" class="btn red" style="margin-left:20px;">

                    批量删除 <i class="icon-minus"></i>

                    </button>
                  </div>

                </div>

                <table class="table table-striped table-hover table-bordered" id="sample_editable_1">

                  <thead>

                    <tr>
                      <th></th>
                      <th>ID</th>
                      <th>会员账号</th>
                      <th>推荐人</th>
                      <th>姓名</th>
                      <th>性别</th>
                      <th>电话</th>
                      <th>库存</th>
                      <th>操作</th>

                    </tr>

                  </thead>
                                   
                  <tbody>
                      <volist name="list" id="vo">
                     
                      <tr class="">
                        <td style="width:20px;"><input type="checkbox" name="goodsid" value="{$vo[id]}" class="selall"></td>
                         <td>{$vo.id}</td>
                        <td>{$vo.username}</td>
                        <td>{$vo.refe_id|User_name}</td>
                        <td>{$vo.id|data_name}</td>
                        <td>{$vo.id|data_sex}</td> 
                        <td>{$vo.id|data_tel}</td> 
                        <td>
                           <if condition="$vo['level'] neq 0">
                             <if condition="$vo['level'] neq 1">
                               <input type="number" name="" class="kucun_num" value="{$vo.id|kucun}" style="width: 50px;" min="0">
                               <button type="button " class="btn white kucun" attr-id="{$vo.id}">调整</button>
                             </if>
                          </if>
                        </td> 
                        <td>
                         <!--  <a href="__CONTROLLER__/edit_level?id={$vo.id}"><button type="button" class="btn blue sel" attr-id="{$vo.id}" >设置会员等级</button></a>  -->
                        <if condition="$vo['level'] neq 0">
                          <if condition="$vo['level'] neq 1">
                         <button type="button" class="btn blue cha" attr-id="{$vo.id}" data-toggle="modal" href="#sum{$vo.id}">查看名下会员数量</button>
                          </if>
                         <button type="button" class="btn green sel" attr-id="{$vo.id}" data-toggle="modal" href="#level{$vo.id}">设置会员等级</button> 
                       </if>
                         <button type="button" class="btn red del" attr-id="{$vo.id}">删除</button>
                          
                        </td>
                                                            
                      </tr>
                     </volist>
                    
                  </tbody>

                </table>
                <div class="pagination" style="float:right;">
                  <ul><li>{$page}</li></ul>
                </div>
              </div>

            </div>

            <!-- END EXAMPLE TABLE PORTLET-->

          </div>

        </div>

        <!-- END PAGE CONTENT -->


      </div>

      <!-- END PAGE CONTAINER-->

    </div>

    <!-- END PAGE -->

  </div>
        <!--=================================-模态框===========================-->
<volist name="list" id="vo">          
<div class="modal fade" id="level{$vo.id}" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
<!-- ======= -->

         <form class="form-horizontal" id="form" action="" method="post" enctype="multipart/form-data">
         <table width="400" border="0" cellpadding="0" cellspacing="1" bgcolor="#a8c7ce" class="table">
                <tr>
                   <td colspan="2" style="border:1px #ccc solid; line-height:30px; background-color:#eee; text-align: center;" height="20" width="200" align=""><b>修改会员等级</b></td>
                 </tr>
                 <tr>
                    <td style="border:1px #ccc solid; line-height:30px;" height="20" width="100" align="center">代理商账号</td>
                    <td style="border:1px #ccc solid;" height="20" width="200" align="center">
                       <input type="text" class="form-control input-sm username" id="quname" name="class_name" style="width:200px;" value="{$vo.username}" />
                    </td>
                 </tr>
                 <tr>
                    <td style="border:1px #ccc solid; line-height:30px;" height="20" width="100" align="center">级别</td>
                    <td style="border:1px #ccc solid;" height="20" width="200" align="center">
                      <select class="span6 m-wrap lev" data-placeholder="Choose a Category" tabindex="1" style="width:200px;" name="level" id="level">
                         <option value=''>- 请选择等级 -</option>
                        <option value='0' <if condition="$vo['level'] eq 0" >selected = selected</if> >- 普通会员 -</option>
                        <option value='1' <if condition="$vo['level'] eq 1" >selected = selected</if>>- VIP会员 -</option>
                        <option value='2' <if condition="$vo['level'] eq 2" >selected = selected</if>>- 代理商 -</option>
                        <option value='3' <if condition="$vo['level'] eq 3" >selected = selected</if>>- 招商总监 -</option>
                        <option value='4' <if condition="$vo['level'] eq 4" >selected = selected</if>>- 招商副总 -</option>
                        <option value='5' <if condition="$vo['level'] eq 5" >selected = selected</if>>- 运营CEO -</option>

                      </select>
                    </td>
                 </tr>
                 <tr>
                    <td style="border:1px #ccc solid;" height="20" width="200" align="center" colspan="2">
                     <button type="button" class="btn btn green btn-sm edit" id="add" attr-id="{$vo.id}" align="center" style="margin-left:200px;">保存</button>
                    </td>
                 </tr>
             
         </table>
        </form>
<!-- ============ -->
        
      </div>
    </div>
  </div>
</div>
</volist>
<script type="text/javascript">
           /*调整库存*/
    $('.kucun').click(function(){
     var a = $('.kucun').index(this);
     var id = $('.kucun').eq(a).attr('attr-id');
     var num = $('.kucun_num').eq(a).val();

     var url = "__CONTROLLER__/kucun";
     var jump_url = "__CONTROLLER__/search";
     var data = {'id':id,'num':num};
     $.post(url,data,function(result){
      if(result.status==1){
            dialog.success(result.message,jump_url);
        }
        if(result.status==0){
            dialog.error(result.message);
        }

     },'JSON');

    });

  $('.edit').click(function(){
    var a = $('.edit').index(this);
    var id = $('.edit').eq(a).attr('attr-id');
    var level = $('.lev').eq(a).val();
    var url = '__CONTROLLER__/edit_level_save';
    var jump_url = '__CONTROLLER__/search';
    var data = {'id':id,'level':level};
    $.post(url,data,function(res){
        if (res.status == 1) {
            dialog.success(res.message,jump_url);
              //window.location.href=jump_url;
            } 
         if(res.status == 0){
            dialog.error(res.message);
        }

     },'JSON');
  });


</script>
<!--=================================-统计数据===========================-->
<volist name="list" id="vo">          
<div class="modal fade" id="sum{$vo.id}" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
<!-- ======= -->

         <form class="form-horizontal" id="form" action="" method="post" enctype="multipart/form-data">
         <table width="400" border="0" cellpadding="0" cellspacing="1" bgcolor="#a8c7ce" class="table">
                <tr>
                   <td colspan="2" style="border:1px #ccc solid; line-height:30px; background-color:#eee; text-align: center;" height="20" width="200" align=""><b>名下会员数量信息</b></td>
                 </tr>
                 <tr> 
                    <td style="border:1px #ccc solid; line-height:30px;" height="20" width="100" align="center">直招代理人数</td>
                    <td style="border:1px #ccc solid;" height="20" width="200" align="center">
                       <span class="q">{$vo.id|daili_sum}</span> 人
                    </td>
                 </tr>
                   <tr>
                    <td style="border:1px #ccc solid; line-height:30px;" height="20" width="100" align="center">直卖VIP人数</td>
                    <td style="border:1px #ccc solid;" height="20" width="200" align="center">
                       <span class="w">{$vo.id|vip_sum}</span> 人
                    </td>
                 </tr>
                   <tr>
                    <td style="border:1px #ccc solid; line-height:30px;" height="20" width="100" align="center">代理团队人数</td>
                    <td style="border:1px #ccc solid;" height="20" width="200" align="center">
                       <span class="e">0</span> 人
                    </td>
                 </tr>
                   <tr>
                    <td style="border:1px #ccc solid; line-height:30px;" height="20" width="100" align="center">VIP总人数</td>
                    <td style="border:1px #ccc solid;" height="20" width="200" align="center">
                       <span class="r">0</span> 人
                    </td>
                 </tr>
              
             
         </table>
        </form>
<!-- ============ -->
        
      </div>
    </div>
  </div>
</div>
</volist>
<script type="text/javascript">
  $('.cha').click(function(){
    var a = $('.cha').index(this);
    var id = $('.cha').eq(a).attr('attr-id');
    var url = '__CONTROLLER__/get_member_value';
    var jump_url = '__CONTROLLER__/search';
    var data = {'id':id};
    $.post(url,data,function(res){
      //var jsondata = $.parseJSON(res);
      $('.e').html(res.daili);
      $('.r').html(res.vip);
     },'JSON');
  });


</script>

  <!-- END CONTAINER -->

  <!-- BEGIN FOOTER -->

<include file="index/footer" />

  <!-- END FOOTER -->

  <!-- BEGIN JAVASCRIPTS(Load javascripts at bottom, this will reduce page load time) -->

  <!-- BEGIN CORE PLUGINS -->

  <script src="__PUBLIC__/media/js/jquery-1.10.1.min.js" type="text/javascript"></script>

  <script src="__PUBLIC__/media/js/jquery-migrate-1.2.1.min.js" type="text/javascript"></script>

  <!-- IMPORTANT! Load jquery-ui-1.10.1.custom.min.js before bootstrap.min.js to fix bootstrap tooltip conflict with jquery ui tooltip -->

  <script src="__PUBLIC__/media/js/jquery-ui-1.10.1.custom.min.js" type="text/javascript"></script>      

  <script src="__PUBLIC__/media/js/bootstrap.min.js" type="text/javascript"></script>

  <!--[if lt IE 9]>

  <script src="__PUBLIC__/media/js/excanvas.min.js"></script>

  <script src="__PUBLIC__/media/js/respond.min.js"></script>  

  <![endif]-->   

  <script src="__PUBLIC__/media/js/jquery.slimscroll.min.js" type="text/javascript"></script>

  <script src="__PUBLIC__/media/js/jquery.blockui.min.js" type="text/javascript"></script>  

  <script src="__PUBLIC__/media/js/jquery.cookie.min.js" type="text/javascript"></script>

  <script src="__PUBLIC__/media/js/jquery.uniform.min.js" type="text/javascript" ></script>

  <!-- END CORE PLUGINS -->

  <!-- BEGIN PAGE LEVEL PLUGINS -->

  <script type="text/javascript" src="__PUBLIC__/media/js/select2.min.js"></script>

  

  <script type="text/javascript" src="__PUBLIC__/media/js/DT_bootstrap.js"></script>

  <!-- END PAGE LEVEL PLUGINS -->

  <!-- BEGIN PAGE LEVEL SCRIPTS -->

  <script src="__PUBLIC__/media/js/app.js"></script>

  <script src="__PUBLIC__/media/js/table-editable.js"></script>    

  <script>

    jQuery(document).ready(function() {       

       App.init();

       TableEditable.init();

    });

   $('#add').click(function(){
     var quname = $('#quname').val();
     var pid = $('#pid').val();
     var url = '__CONTROLLER__/add';
     var jump_url = '__CONTROLLER__/index';
     var data={'pid':pid,'name':quname}
       $.post(url,data,function(res){
         if(res.status==1){
            dialog.success(res.message,jump_url);
         }
         if(res.status==0){
            dialog.error(res.message);
         }

       },'JSON');

   })
  $('.del').click(function(){
     var a = $('.del').index(this);
     var id = $('.del').eq(a).attr('attr-id');
     //alert(id);
     var url = '__CONTROLLER__/del';
     var jump_url = '__CONTROLLER__/index';
     var data={'id':id}
     layer.open({
        type:0,
        title:'删除',
        btn:['yes','no'], 
        icon:3,
        closeBtn:2,
        content: '是否真的删除这条数据？',
        scrollbar:true,
        yes:function () {
         $.post(url,data,function(res){
         if(res.status==1){
            dialog.success(res.message,jump_url);
         }
         if(res.status==0){
            dialog.error(res.message);
         }

       },'JSON');
 
        },
    });
     
    });

     $('#delall').click(function(){
    var goodsid={};
    $("input[name='goodsid']:checked").each(function (i) {
          goodsid[i]=$(this).val();
     });
    var url="__CONTROLLER__/bdel";
    var jump_url="__CONTROLLER__/index";
        layer.open({
        type:0,
        title:'批量删除',
        btn:['yes','no'], 
        icon:3,
        closeBtn:2,
        content: '是否真的删除这些数据？',
        scrollbar:true,
        yes:function () {
         $.post(url,goodsid,function(res){
         if(res.status==1){
            dialog.success(res.message,jump_url);
         }
         if(res.status==0){
            dialog.error(res.message);
         }

       },'JSON');
 
        },
    });
  })
  </script>

<!-- <script type="text/javascript">  var _gaq = _gaq || [];  _gaq.push(['_setAccount', 'UA-37564768-1']);  _gaq.push(['_setDomainName', 'keenthemes.com']);  _gaq.push(['_setAllowLinker', true]);  _gaq.push(['_trackPageview']);  (function() {    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;    ga.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + 'stats.g.doubleclick.net/dc.js';    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);  })();</script> --></body>

<!-- END BODY -->

</html>