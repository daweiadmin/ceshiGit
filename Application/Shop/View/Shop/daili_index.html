<!DOCTYPE html>
<include file="index/head" />
  <!-- END HEADER -->

  <!-- BEGIN CONTAINER -->

  <div class="page-container row-fluid">

    <!-- BEGIN SIDEBAR   MENU-->

      <include file="index/left" />

    <!-- END SIDEBAR -->

    <!-- BEGIN PAGE -->

    <div class="page-content">

      <!-- BEGIN SAMPLE PORTLET CONFIGURATION MODAL FORM-->

      <div id="portlet-config" class="modal hide">

        <div class="modal-header">

          <button data-dismiss="modal" class="close" type="button"></button>

          <h3>portlet Settings</h3>

        </div>

        <div class="modal-body">

          <p>Here will be a configuration form</p>

        </div>

      </div>

      <!-- END SAMPLE PORTLET CONFIGURATION MODAL FORM-->

      <!-- BEGIN PAGE CONTAINER-->        

      <div class="container-fluid">

        <!-- BEGIN PAGE HEADER-->

        <div class="row-fluid">

          <div class="span12">

            <!-- BEGIN STYLE CUSTOMIZER -->
                         
            <!-- END BEGIN STYLE CUSTOMIZER -->  

            <!-- BEGIN PAGE TITLE & BREADCRUMB-->

            <h3 class="page-title">

              代理管理 <small></small>

            </h3>

            <ul class="breadcrumb">


              <li>

                <a href="#">代理 / 商户管理</a>

                <i class="icon-angle-right"></i>

              </li>

              <li><a href="#">代理列表</a></li>

            </ul>

            <!-- END PAGE TITLE & BREADCRUMB-->

          </div>

        </div>

        <!-- END PAGE HEADER-->

        <!-- BEGIN PAGE CONTENT-->

        <div class="row-fluid">

          <div class="span12">

            <!-- BEGIN EXAMPLE TABLE PORTLET-->

            <div class="portlet box blue">

              <div class="portlet-title">

                <div class="caption"><i class="icon-edit"></i>代理列表</div>

                <div class="tools">

                  <a href="javascript:;" class="collapse"></a>

                  <a href="#portlet-config" data-toggle="modal" class="config"></a>

                  <a href="javascript:;" class="reload"></a>

                  <a href="javascript:;" class="remove"></a>

                </div>

              </div>

              <div class="portlet-body">

                <div class="clearfix" style="height: 50px;">

                  <div class="btn-group">
                     <a href="__CONTROLLER__/add_daili"><button type="button" class="btn blue ">新增代理</button> </a>
                      
                    <!--  <button id="delall" class="btn red" style="margin-left:20px;">
                    
                                        批量删除 <i class="icon-minus"></i>
                    
                                        </button> -->
                     <form class="sidebar-search" style="display:inline-block; float:right; margin-left:10px; " method="post" action="__CONTROLLER__/daili_index">

                       <input type="text" placeholder="代理昵称 / 姓名" name="search" style="width:200px; display:inline-block; height:24px;"/>
                       <button type="submit"  class="btn green" style=" display:inline-block; float:right;">
                       <i class="icon-search"></i>
                             搜索
                        </button>
                      
                  </form>
                  </div>

                </div>

                <table class="table table-striped table-hover table-bordered" id="sample_editable_1">

                  <thead>

                    <tr>
                      <th></th>
                      <th style="text-align: center;">ID</th>
                      <th style="text-align: center;">用户名</th>
                      <th style="text-align: center;">账户余额</th>
                      <th style="text-align: center;">累计金额</th>
                      <th style="text-align: center;">在投活动金额</th>
                      <th style="text-align: center;">代理名称</th>
                      <th style="text-align: center;">联系人</th>
                      <th style="text-align: center;">联系电话</th>
                     <!--  <th style="text-align: center;">备注</th> -->
                      <th style="text-align: center;">级别</th>
                      <th style="text-align: center;">注册时间</th>
                      <th style="text-align: center;">状态</th>
                      <th style="text-align: center;">操作</th>
                    </tr>

                  </thead>
                                   
                  <tbody>
                      <volist name="tree" id="vo">
                     
                      <tr class="">
                        <td style="width:20px;"><input type="checkbox" name="goodsid" value="{$vo[id]}" class="selall"></td>
                        <td style="text-align: center;">{$vo.id}</td>
                        <td style="text-align: center;">{$vo.username}</td>
                        <td style="text-align: center;">{$vo.money}元</td>
                         <td style="text-align: center;">{$vo.id|chongzhi_total}元</td>
                         <td style="text-align: center;">{$vo.id|act_total}元</td>
                        <td style="text-align: center;">{$vo.name}</td>
                        <td style="text-align: center;">{$vo.link_man}</td>
                        <td style="text-align: center;">{$vo.phone}</td>
                        <td style="text-align: center;">{$vo.type|level}</td>
                        <td style="text-align: center;">{$vo.time|date="y-m-d H:i",###}</td>
                         <td style="text-align: center;">
                          <if condition="$vo[status] eq 1">
                             <button type="button" class="btn green suo mini" attr-id="{$vo.id}">正常</button>
                          </if>
                          <if condition="$vo[status] eq -1">
                             <button type="button" class="btn red jie mini" attr-id="{$vo.id}">冻结</button>
                          </if>
                           <if condition="$vo[status] eq -2">
                            <button type="button" class="btn red mini jujue" attr-val="{$vo.content}">审核不通过</button>
                           </if>
                           <if condition="$vo[status] eq 0">
                              <span style="color: red;">未审核</span>
                           </if>
                        </td>                            
                        <td style="text-align: center;">
                          <!-- <button type="button" class="btn green mini" attr-id="{$vo.id}" data-toggle="modal" href="#level{$vo.id}">详情</button> -->
                           <button type="button" class="btn blue mini click_shop" attr-id="{$vo.id}" data-toggle="modal" href="#fenpei">分配码段</button>
                           <button type="button" class="btn red change_pwd mini" attr-id="{$vo.id}">重置密码</button>
                           <a href="__CONTROLLER__/edit_daili?shop_id={$vo.id}"><button type="button" class="btn green mini">修改</button></a>
                           <!-- <a href="__CONTROLLER__/login_change?login_id={$vo.id}">
                             <button type="button" class="btn yellow mini">管理</button>
                            </a> -->
                        </td>
                                                            
                      </tr>
                     </volist>
                    
                  </tbody>

                </table>
                <div class="pagination" style="float:right;">
                  <ul><li>{$page}</li></ul>
                </div>
              </div>

            </div>

            <!-- END EXAMPLE TABLE PORTLET-->

          </div>

        </div>
      <script type="">
         //申请不通过按钮点击事件
      $('.jujue').click(function(){
       var a = $('.jujue').index(this);
       var val = $('.jujue').eq(a).attr('attr-val');
       dialog.error(val);
      });

    $('.suo').click(function(){
     var a = $('.suo').index(this);
     var id = $('.suo').eq(a).attr('attr-id');
     var url = "__CONTROLLER__/suo";
     var jump_url = "__CONTROLLER__/daili_index";
     var data = {'id':id};
     $.post(url,data,function(result){
      if(result.status==1){
            dialog.success(result.message,jump_url);
        }
        if(result.status==0){
            dialog.error(result.message);
        }

     },'JSON');

    });

    $('.jie').click(function(){
     var a = $('.jie').index(this);
     var id = $('.jie').eq(a).attr('attr-id');
     var url = "__CONTROLLER__/jie";
     var jump_url = "__CONTROLLER__/daili_index";
     var data = {'id':id};
     $.post(url,data,function(result){
      if(result.status==1){
            dialog.success(result.message,jump_url);
        }
        if(result.status==0){
            dialog.error(result.message);
        }

     },'JSON');

    });

 
  $('.change_pwd').click(function(){
     var a = $('.change_pwd').index(this);
     var id = $('.change_pwd').eq(a).attr('attr-id');
     //alert(id);
     var url = '__CONTROLLER__/change';
     var jump_url = '__CONTROLLER__/daili_index';
     var data={'id':id}
     layer.open({
        type:0,
        title:'重置',
        btn:['确认重置','我再想想'], 
        icon:3,
        closeBtn:2,
        content: '是否真的要重置该账号的密码？',
        scrollbar:true,
        yes:function () {
         $.post(url,data,function(res){
         if(res.status==1){
            dialog.success(res.message,jump_url);
         }
         if(res.status==0){
            dialog.error(res.message);
         }

       },'JSON');
 
        },
    });
     
    });

  </script>
        <!-- END PAGE CONTENT -->


      </div>

      <!-- END PAGE CONTAINER-->

    </div>

    <!-- END PAGE -->

  </div>
  <!--=================================-分配码段===========================-->
       
<div class="modal fade" id="fenpei" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
<!-- ======= -->

         <form class="form-horizontal" id="form_fenpei" action="" method="post" enctype="multipart/form-data">
          <table class="table table-striped table-hover table-bordered" id="sample_editable_1">

                  <thead>
                      <tr>
                      <th colspan="10" style="text-align: center;">分配码段</th>
                      </tr>
                    <tr>
                      <th></th>
                      <th style="text-align: center;">ID</th>
                      <th style="text-align: center;">批号</th>
                      <th style="text-align: center;">码段</th>
                      <th style="text-align: center;">数量</th>
                      <th style="text-align: center;">生成时间</th>
                    </tr>

                  </thead>
                                   
                  <tbody>
                   <?php if(!empty($code_list)){ ?>
                      <volist name="code_list" id="vo">
                     
                      <tr class="">
                        <td style="width:20px;">
                          <input type="checkbox" name="code_num_id[]" value="{$vo.id}">
                        </td>
                        <td style="text-align: center;">{$vo.id}</td>
                        <td style="text-align: center;">{$vo.pici}</td>
                        <td style="text-align: center; color: blue;">{$vo.code_number}</td>
                        <td style="text-align: center;">{$vo.id|code_num}</td>
                        <td style="text-align: center;">{$vo.time|date="y-m-d H:i",###}</td>    
                                                            
                      </tr>
                     </volist>
                       <?php }else{ ?>
                       <tr>
                          <td style="text-align: center;" colspan="10">暂未分配码段，快去联系代理商吧！</td>
                       </tr>
                      <?php  }  ?>
                    <tr>
                     
                     <td colspan="10" style="text-align: center;">
                       <input type="hidden" id="click_shop_id" name="click_shop_id">
                       <button class="btn blue" id="click_fenpei" type="button">确认分配</button>
                      </td>
                    </tr>
                  </tbody>

                </table>
                <div class="pagination" style="float:right;">
                  <ul><li>{$code_page}</li></ul>
                </div>
        </form>
<!-- ============ -->
        
      </div>
    </div>
  </div>
</div>


<script>
      $('.click_shop').click(function(){
       var a = $('.click_shop').index(this);
       var id = $('.click_shop').eq(a).attr('attr-id');
       $('#click_shop_id').val(id);

      });

    $('#click_fenpei').click(function(){
     var data=$('#form_fenpei').serialize(); 
     var url = "__CONTROLLER__/fenpei";
     var jump_url = "__CONTROLLER__/daili_index";
     $.post(url,data,function(result){
        
       if(result.status==1){
            dialog.success(result.message,jump_url);
        }
        if(result.status==0){
            dialog.error(result.message);
        }

     },'JSON');

    });

</script>
        <!--=================================-模态框===========================-->
<!-- <volist name="tree" id="vo">          
<div class="modal fade" id="level{$vo.id}" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
=======

         <form class="form-horizontal" id="form" action="" method="post" enctype="multipart/form-data">
         <table width="400" border="0" cellpadding="0" cellspacing="1" bgcolor="#a8c7ce" class="table">
                <tr>
                   <td colspan="2" style="border:1px #ccc solid; line-height:30px; background-color:#eee; text-align: center;" height="20" width="200" align=""><b>查看商户详情</b></td>
                 </tr>
                 <tr>
                    <td style="border:1px #ccc solid; line-height:30px;" height="20" width="100" align="center">商户名称</td>
                    <td style="border:1px #ccc solid;" height="20" width="200" align="center">
                       {$vo.name}
                    </td>
                 </tr>
                   <tr>
                    <td style="border:1px #ccc solid; line-height:30px;" height="20" width="100" align="center">联系人</td>
                    <td style="border:1px #ccc solid;" height="20" width="200" align="center">
                       {$vo.link_man}
                    </td>
                 </tr>
                   <tr>
                    <td style="border:1px #ccc solid; line-height:30px;" height="20" width="100" align="center">联系电话</td>
                    <td style="border:1px #ccc solid;" height="20" width="200" align="center">
                      {$vo.phone}
                    </td>
                 </tr>
                   <tr>
                    <td style="border:1px #ccc solid; line-height:30px;" height="20" width="100" align="center">邮箱</td>
                    <td style="border:1px #ccc solid;" height="20" width="200" align="center">
                      {$vo.email}
                       
                    </td>
                 </tr>
                 <tr>
                    <td style="border:1px #ccc solid; line-height:30px;" height="20" width="100" align="center">地址</td>
                    <td style="border:1px #ccc solid;" height="20" width="200" align="center">
                       {$vo.address}
                    </td>
                 </tr>
                 <tr>
                    <td style="border:1px #ccc solid; line-height:30px;" height="20" width="100" align="center">账户余额</td>
                    <td style="border:1px #ccc solid;" height="20" width="200" align="center">
                       {$vo.money}
                    </td>
                 </tr>
                 <tr>
                    <td style="border:1px #ccc solid; line-height:30px;" height="20" width="100" align="center">累计消耗金额</td>
                    <td style="border:1px #ccc solid;" height="20" width="200" align="center">
                       0.00
                    </td>
                 </tr>
                 <tr>
                    <td style="border:1px #ccc solid; line-height:30px;" height="20" width="100" align="center">投入活动金额</td>
                    <td style="border:1px #ccc solid;" height="20" width="200" align="center">
                       0.00
                    </td>
                 </tr>
                 <tr>
                    <td style="border:1px #ccc solid; line-height:30px;" height="20" width="100" align="center">公众号原始ID</td>
                    <td style="border:1px #ccc solid;" height="20" width="200" align="center">
                       0
                    </td>
                 </tr>
                 <tr>
                    <td style="border:1px #ccc solid; line-height:30px;" height="20" width="100" align="center">创建时间</td>
                    <td style="border:1px #ccc solid;" height="20" width="200" align="center">
                       {$vo.time|date="y-m-d H:i",###}
                    </td>
                 </tr>
                  <tr>
                    <td style="border:1px #ccc solid; line-height:30px;" height="20" width="100" align="center">有效期至</td>
                    <td style="border:1px #ccc solid;" height="20" width="200" align="center">
                       {$vo.end_time|date="y-m-d H:i",###}
                    </td>
                 </tr>
                
                
             
         </table>
        </form>
============
        
      </div>
    </div>
  </div>
</div>
</volist> -->
<script type="text/javascript">
  $('.edit').click(function(){
    var a = $('.edit').index(this);
    var id = $('.edit').eq(a).attr('attr-id');
    var level = $('.lev').eq(a).val();
    var url = '__CONTROLLER__/edit_level_save';
    var jump_url = '__CONTROLLER__/daili_index';
    var data = {'id':id,'level':level};
    $.post(url,data,function(res){
        if (res.status == 1) {
            dialog.success(res.message,jump_url);
              //window.location.href=jump_url;
            } 
         if(res.status == 0){
            dialog.error(res.message);
        }

     },'JSON');
  });


</script>
<!--=================================-统计数据===========================-->
<volist name="list" id="vo">          
<div class="modal fade" id="sum{$vo.id}" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
<!-- ======= -->

         <form class="form-horizontal" id="form" action="" method="post" enctype="multipart/form-data">
         <table width="400" border="0" cellpadding="0" cellspacing="1" bgcolor="#a8c7ce" class="table">
                <tr>
                   <td colspan="2" style="border:1px #ccc solid; line-height:30px; background-color:#eee; text-align: center;" height="20" width="200" align=""><b>名下代理数量信息</b></td>
                 </tr>
                 <tr>
                    <td style="border:1px #ccc solid; line-height:30px;" height="20" width="100" align="center">直招代理人数</td>
                    <td style="border:1px #ccc solid;" height="20" width="200" align="center">
                       <span class="q">100</span> 人
                    </td>
                 </tr>
                   <tr>
                    <td style="border:1px #ccc solid; line-height:30px;" height="20" width="100" align="center">直卖VIP人数</td>
                    <td style="border:1px #ccc solid;" height="20" width="200" align="center">
                       <span class="q"></span> 人
                    </td>
                 </tr>
                   <tr>
                    <td style="border:1px #ccc solid; line-height:30px;" height="20" width="100" align="center">代理团队人数</td>
                    <td style="border:1px #ccc solid;" height="20" width="200" align="center">
                       <span class="q"></span> 人
                    </td>
                 </tr>
                   <tr>
                    <td style="border:1px #ccc solid; line-height:30px;" height="20" width="100" align="center">VIP总人数</td>
                    <td style="border:1px #ccc solid;" height="20" width="200" align="center">
                       <span class="q"></span> 人
                    </td>
                 </tr>
              
             
         </table>
        </form>
<!-- ============ -->
        
      </div>
    </div>
  </div>
</div>
</volist>
<script type="text/javascript">
/*  $('.edit').click(function(){
    var a = $('.edit').index(this);
    var id = $('.edit').eq(a).attr('attr-id');
    var level = $('.lev').eq(a).val();
    var url = '__CONTROLLER__/edit_level_save';
    var jump_url = '__CONTROLLER__/daili_index';
    var data = {'id':id,'level':level};
    $.post(url,data,function(res){
        if (res.status == 1) {
            dialog.success(res.message,jump_url);
              //window.location.href=jump_url;
            } 
         if(res.status == 0){
            dialog.error(res.message);
        }

     },'JSON');
  });*/


</script>

  <!-- END CONTAINER -->

  <!-- BEGIN FOOTER -->

<include file="index/footer" />

  <!-- END FOOTER -->

  <!-- BEGIN JAVASCRIPTS(Load javascripts at bottom, this will reduce page load time) -->

  <!-- BEGIN CORE PLUGINS -->

  <script src="__PUBLIC__/media/js/jquery-1.10.1.min.js" type="text/javascript"></script>

  <script src="__PUBLIC__/media/js/jquery-migrate-1.2.1.min.js" type="text/javascript"></script>

  <!-- IMPORTANT! Load jquery-ui-1.10.1.custom.min.js before bootstrap.min.js to fix bootstrap tooltip conflict with jquery ui tooltip -->

  <script src="__PUBLIC__/media/js/jquery-ui-1.10.1.custom.min.js" type="text/javascript"></script>      

  <script src="__PUBLIC__/media/js/bootstrap.min.js" type="text/javascript"></script>

  <!--[if lt IE 9]>

  <script src="__PUBLIC__/media/js/excanvas.min.js"></script>

  <script src="__PUBLIC__/media/js/respond.min.js"></script>  

  <![endif]-->   

  <script src="__PUBLIC__/media/js/jquery.slimscroll.min.js" type="text/javascript"></script>

  <script src="__PUBLIC__/media/js/jquery.blockui.min.js" type="text/javascript"></script>  

  <script src="__PUBLIC__/media/js/jquery.cookie.min.js" type="text/javascript"></script>

  <script src="__PUBLIC__/media/js/jquery.uniform.min.js" type="text/javascript" ></script>

  <!-- END CORE PLUGINS -->

  <!-- BEGIN PAGE LEVEL PLUGINS -->

  <script type="text/javascript" src="__PUBLIC__/media/js/select2.min.js"></script>

  

  <script type="text/javascript" src="__PUBLIC__/media/js/DT_bootstrap.js"></script>

  <!-- END PAGE LEVEL PLUGINS -->

  <!-- BEGIN PAGE LEVEL SCRIPTS -->

  <script src="__PUBLIC__/media/js/app.js"></script>

  <script src="__PUBLIC__/media/js/table-editable.js"></script>    

  <script>

    jQuery(document).ready(function() {       

       App.init();

       TableEditable.init();

    });

/*   $('#add').click(function(){
     var quname = $('#quname').val();
     var pid = $('#pid').val();
     var url = '__CONTROLLER__/add';
     var jump_url = '__CONTROLLER__/index';
     var data={'pid':pid,'name':quname}
       $.post(url,data,function(res){
         if(res.status==1){
            dialog.success(res.message,jump_url);
         }
         if(res.status==0){
            dialog.error(res.message);
         }

       },'JSON');

   })*/
  $('.del').click(function(){
     var a = $('.del').index(this);
     var id = $('.del').eq(a).attr('attr-id');
     //alert(id);
     var url = '__CONTROLLER__/del';
     var jump_url = '__CONTROLLER__/index';
     var data={'id':id}
     layer.open({
        type:0,
        title:'删除',
        btn:['yes','no'], 
        icon:3,
        closeBtn:2,
        content: '是否真的删除这条数据？',
        scrollbar:true,
        yes:function () {
         $.post(url,data,function(res){
         if(res.status==1){
            dialog.success(res.message,jump_url);
         }
         if(res.status==0){
            dialog.error(res.message);
         }

       },'JSON');
 
        },
    });
     
    });

     $('#delall').click(function(){
    var goodsid={};
    $("input[name='goodsid']:checked").each(function (i) {
          goodsid[i]=$(this).val();
     });
    var url="__CONTROLLER__/bdel";
    var jump_url="__CONTROLLER__/index";
        layer.open({
        type:0,
        title:'批量删除',
        btn:['yes','no'], 
        icon:3,
        closeBtn:2,
        content: '是否真的删除这些数据？',
        scrollbar:true,
        yes:function () {
         $.post(url,goodsid,function(res){
         if(res.status==1){
            dialog.success(res.message,jump_url);
         }
         if(res.status==0){
            dialog.error(res.message);
         }

       },'JSON');
 
        },
    });
  })
  </script>

<!-- <script type="text/javascript">  var _gaq = _gaq || [];  _gaq.push(['_setAccount', 'UA-37564768-1']);  _gaq.push(['_setDomainName', 'keenthemes.com']);  _gaq.push(['_setAllowLinker', true]);  _gaq.push(['_trackPageview']);  (function() {    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;    ga.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + 'stats.g.doubleclick.net/dc.js';    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);  })();</script> --></body>

<!-- END BODY -->

</html>